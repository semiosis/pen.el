 Control.Concurrent ( forkIO , threadDelay )

import Control.Monad ( msum )

import Data.IORef ( newIORef , readIORef , writeIORef ,

atomicModifyIORef
